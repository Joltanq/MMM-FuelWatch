{% macro escapeText(text, dangerouslyDisableAutoEscaping=false) %}
  {% if dangerouslyDisableAutoEscaping %}
    {{ text | safe}}
  {% else %}
    {{ text }}
  {% endif %}
{% endmacro %}

{% if loaded %}
    {% if config.showAsList %}
                                    
    {% else %}

        


        {% set minToday = 0 %}
        {% set minTomorrow = 0 %}
        <div>
        {% for item in items| sort(false,true, 'price')  %}    
            {% if loop.index0 == 0 %}

                {% set minToday = item.price %}
            {% endif %}
        {% endfor %}

        {% for item in items| sort(false,true, 'pricetomorrow')  %}    
            {% if loop.index0 == 0 %}
    
                {% set minTomorrow = item.pricetomorrow %}
            {% endif %}
        {% endfor %}
        


            <table>
                <thead>
                    <tr>

                        <th>Logo</th>
                        <th>Servo Name</th>
                        <th>Today Price</th>
                        <th>Tomorrow Price</th>

                    </tr>   
                </thead>
                <tbody>

                    {% for item in items  %}    
                      
                        
                        <tr>
                            <td> <img src="..\modules\default\newsfeed\logo\{{item.brand}}.svg" width = "50" height = "50"   /> </td>
                            <td>{{item.trading_name}}</td> 
                            {% if item.price == minToday %}          
                                <td style = "color:red;"> {{item.price}} </td>
                            {% else %}
                                <td> {{item.price}} </td>
                            {% endif %}
                            {% if item.pricetomorrow == minTomorrow %}     
                                <td style = "color:red;"> {{item.pricetomorrow}} </td>
                            {% else %}
                                <td> {{item.pricetomorrow}} </td>
                            {% endif %}
                          

                            </tr>
                           

                    {% endfor %}

                      
                </tbody>
            </table>




            {% if config.showDescription %}
                <div class="newsfeed-desc small light{{ ' no-wrap' if not config.wrapDescription }}">
                    {% if config.truncDescription %}
                        {{ escapeText(description | truncate(config.lengthDescription), config.dangerouslyDisableAutoEscaping) }}

                    {% endif %}
                </div>
            {% endif %}
        </div>
    {% endif %}
{% elseif empty %}
    <div class="small dimmed">
        {{ "NEWSFEED_NO_ITEMS" | translate | safe }}
    </div>
{% elseif error %}
    <div class="small dimmed">
        {{ "MODULE_CONFIG_ERROR" | translate({MODULE_NAME: "Newsfeed", ERROR: error}) | safe }}
    </div>
{% else %}>
{% endif %}
